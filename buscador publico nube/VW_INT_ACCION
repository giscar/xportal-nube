
  CREATE OR REPLACE FORCE VIEW "REG_PROCESOS"."VW_INT_ACCION" ("N_ID_CONTRATO", "C_NRO", "C_TIPO", "D_FECPUB", "C_MONTO", "N_MONTO", "C_TIPMON", "C_NROI", "C_PLAZO", "C_ITEMS", "C_ARCHIVO") AS 
  SELECT 
CONTRATO_RESOLUCION.N_COD_CONTRATO N_ID_CONTRATO,
ROWNUM C_NRO,
'NULIDAD DE CONTRATO' C_TIPO,
CONTRATO_RESOLUCION.FEC_CREACION D_FECPUB,
NULL AS C_MONTO,
NULL AS N_MONTO,
NULL AS C_TIPMON,0 AS C_NROI,
NULL AS C_PLAZO,
NULL AS C_ITEMS,
CAST (DECODE(CONVOCATORIA_DOC.DOC_URL,NULL,NULL,'https://zonasegura2.seace.gob.pe/documentos/'--'http://172.16.1.190:8096/documentosportal/'
|| CONVOCATORIA_DOC.DOC_URL) AS VARCHAR2(1000)) C_ARCHIVO
FROM REG_PROCESOS.CONTRATO_RESOLUCION CONTRATO_RESOLUCION
LEFT OUTER JOIN REG_PROCESOS.CONVOCATORIA_DOC CONVOCATORIA_DOC
ON CONTRATO_RESOLUCION.N_COD_CONTRATO = CONVOCATORIA_DOC.N_COD_CONTRATO
AND CONTRATO_RESOLUCION.ESTADO_CONTRATO = 2
AND CONVOCATORIA_DOC.COD_TIPO_DOC = 620
UNION
--RESOLUCION
SELECT 
CONTRATO_RESOLUCION.N_COD_CONTRATO N_ID_CONTRATO,
ROWNUM C_NRO,
'RESOLUCION DE CONTRATO' C_TIPO,
CONTRATO_RESOLUCION.FEC_CREACION D_FECPUB,
NULL AS C_MONTO,
NULL AS N_MONTO,
NULL AS C_TIPMON,0 AS C_NROI,
NULL AS C_PLAZO,
NULL AS C_ITEMS,
CAST (DECODE(CONVOCATORIA_DOC.DOC_URL,NULL,NULL,'https://zonasegura2.seace.gob.pe/documentos/'--'http://172.16.1.190:8096/documentosportal/'
|| CONVOCATORIA_DOC.DOC_URL) AS VARCHAR2(1000)) C_ARCHIVO
FROM REG_PROCESOS.CONTRATO_RESOLUCION CONTRATO_RESOLUCION
LEFT OUTER JOIN REG_PROCESOS.CONVOCATORIA_DOC CONVOCATORIA_DOC
ON CONTRATO_RESOLUCION.N_COD_CONTRATO = CONVOCATORIA_DOC.N_COD_CONTRATO
AND CONTRATO_RESOLUCION.ESTADO_CONTRATO = 1
AND CONVOCATORIA_DOC.COD_TIPO_DOC = 610
UNION
--ADELANTO
SELECT
ADELANTO.N_COD_CONTRATO N_ID_CONTRATO,
ROWNUM C_NRO,
'ADELANTO' C_TIPO,
ADELANTO.FEC_DOC_ADELANTO D_FECPUB,
CAST (ADELANTO.MONTO_PAGO AS VARCHAR2(50)) C_MONTO,
CAST (ADELANTO.MONTO_PAGO AS NUMBER) N_MONTO,
ADELANTO.CODMONEDA C_TIPMON,0 AS C_NROI,
NULL AS C_PLAZO,
NULL AS C_ITEMS,
NULL AS C_ARCHIVO
FROM REG_PROCESOS.ADELANTO ADELANTO
UNION
--ADICIONAL
SELECT 
ADICIONAL_REDUCCION.N_COD_CONTRATO N_ID_CONTRATO,
ROWNUM C_NRO,
'ADICIONAL' C_TIPO,
ADICIONAL_REDUCCION.FEC_DOC_ADICIONAL D_FECPUB,
CAST (ADICIONAL_REDUCCION.MONTO_ADICIONAL AS VARCHAR2(50)) C_MONTO,
CAST (ADICIONAL_REDUCCION.MONTO_ADICIONAL AS NUMBER) N_MONTO,
ADICIONAL_REDUCCION.CODMONEDA C_TIPMON,ADICIONAL_REDUCCION.COD_ADICIONAL AS C_NROI,
NULL AS C_PLAZO,
NULL AS C_ITEMS, --?
NULL AS C_ARCHIVO
FROM REG_PROCESOS.ADICIONAL_REDUCCION ADICIONAL_REDUCCION
WHERE IND_ADICIONAL_REDUCCION = '1'
UNION
--REDUCCION
SELECT 
ADICIONAL_REDUCCION.N_COD_CONTRATO N_ID_CONTRATO,
ROWNUM C_NRO,
'ADICIONAL' C_TIPO,
ADICIONAL_REDUCCION.FEC_DOC_ADICIONAL D_FECPUB,
CAST (ADICIONAL_REDUCCION.MONTO_ADICIONAL AS VARCHAR2(50)) C_MONTO,
CAST (ADICIONAL_REDUCCION.MONTO_ADICIONAL AS NUMBER) N_MONTO,
ADICIONAL_REDUCCION.CODMONEDA C_TIPMON,ADICIONAL_REDUCCION.COD_ADICIONAL AS C_NROI,
NULL AS C_PLAZO,
NULL AS C_ITEMS, --?
NULL AS C_ARCHIVO
From Reg_Procesos.Adicional_Reduccion Adicional_Reduccion
WHERE IND_ADICIONAL_REDUCCION = '2' -- REDUCCION;


UNION
--Prorroga
SELECT 
Contrato.N_COD_CONTRATO N_ID_CONTRATO,
ROWNUM C_NRO,
'PRORROGA' C_TIPO,
Convocatoria_doc.FEC_UPLOAD D_FECPUB,
CAST (Contrato.M_CONTRATADO AS VARCHAR2(50)) C_MONTO,
CAST (Contrato.M_CONTRATADO AS NUMBER) N_MONTO,
Contrato.CODMONEDA_CONTRATO C_TIPMON,Convocatoria_DOC.COD_ADICIONAL AS C_NROI,
NULL AS C_PLAZO,
NULL AS C_ITEMS, --?
NULL AS C_ARCHIVO
From Reg_Procesos.Contrato Contrato inner join Reg_procesos.convocatoria_DOC Convocatoria_DOC on Contrato.n_cod_contrato=Convocatoria_doc.cod_proro
WHERE Contrato.cod_operacion_contrato=2 -- prorroga;

UNION
--Prorroga
SELECT 
Contrato.N_COD_CONTRATO N_ID_CONTRATO,
ROWNUM C_NRO,
'COMPLEMENTARIO' C_TIPO,
Convocatoria_doc.FEC_UPLOAD D_FECPUB,
CAST (Contrato.M_CONTRATADO AS VARCHAR2(50)) C_MONTO,
CAST (Contrato.M_CONTRATADO AS NUMBER) N_MONTO,
Contrato.CODMONEDA_CONTRATO C_TIPMON,Convocatoria_DOC.COD_ADICIONAL AS C_NROI,
NULL AS C_PLAZO,
NULL AS C_ITEMS, --?
NULL AS C_ARCHIVO
From Reg_Procesos.Contrato Contrato inner join Reg_procesos.convocatoria_DOC Convocatoria_DOC on Contrato.n_cod_contrato=Convocatoria_doc.cod_proro
WHERE Contrato.cod_operacion_contrato=6 -- prorroga;
;
