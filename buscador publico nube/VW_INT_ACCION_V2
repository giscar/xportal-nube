
  CREATE OR REPLACE FORCE VIEW "REG_PROCESOS"."VW_INT_ACCION_V2" ("N_ID_CONTRATO", "N_ID_CONTRATO2", "C_NRO", "C_TIPO", "D_FECPUB", "C_MONTO", "N_MONTO", "C_NROI", "C_PLAZO", "C_ITEMS", "C_ARCHIVO", "D_FECREGARC", "C_TAM_ARCHIVO") AS 
  SELECT 
     CONTRATO_RESOLUCION.N_COD_CONTRATO N_ID_CONTRATO,
     NULL AS N_ID_CONTRATO2,
    --CAST (CONTRATO_RESOLUCION.N_COD_RESOLUCION AS VARCHAR2(50)) C_NRO,--*
        CAST (ICON.PROC_ITEM AS VARCHAR2(50)) C_NRO, --*

    'NULIDAD DE CONTRATO' C_TIPO,
    CONTRATO_RESOLUCION.FEC_CREACION D_FECPUB,--22082016
    --CONTRATO_RESOLUCION.FEC_RESOLUCION D_FECPUB, 
    CAST (ICON.MONTO AS VARCHAR2(50)) C_MONTO,
    CAST (ICON.MONTO AS NUMBER) N_MONTO,
    CAST (CONTRATO_RESOLUCION.N_COD_RESOLUCION AS VARCHAR2(50)) C_NROI, 
    DECODE(CONTRATO.PLAZO,NULL,NULL,CONTRATO.PLAZO) AS C_PLAZO, 
    ICON.PROC_ITEM AS C_ITEMS, --08092016
    CAST (DECODE(CONVOCATORIA_DOC.DOC_URL,NULL,NULL,'https://zonasegura2.seace.gob.pe/documentos/'--'http://172.16.1.190:8096/documentosportal/'
    || CONVOCATORIA_DOC.DOC_URL) AS VARCHAR2(1000)) C_ARCHIVO,
	 CONVOCATORIA_DOC.FEC_UPLOAD  D_FECREGARC,
   -- CONVOCATORIA_DOC.TAMANO_BYTES AS C_TAM_ARCHIVO --22082016
    --IC.DESCRIPCION AS C_DESCRIPCION --07092016
    CONTRATO_RESOLUCION.ESTADO_CONTRATO AS C_TAM_ARCHIVO
    FROM REG_PROCESOS.CONTRATO_RESOLUCION CONTRATO_RESOLUCION
    LEFT OUTER JOIN REG_PROCESOS.CONVOCATORIA_DOC CONVOCATORIA_DOC
    ON CONTRATO_RESOLUCION.N_COD_CONTRATO = CONVOCATORIA_DOC.N_COD_CONTRATO
    --AND CONTRATO_RESOLUCION.ESTADO_CONTRATO = 2
    AND CONTRATO_RESOLUCION.COD_TIPO_RESOLUCION = 1 --nulidad
    AND CONVOCATORIA_DOC.COD_TIPO_DOC = 620
    --AND CONVOCATORIA_DOC.COD_TIPO_DOC NOT IN (600,620,700,1600,2450)
    INNER JOIN REG_PROCESOS.CONTRATO CONTRATO --*
    ON CONTRATO_RESOLUCION.N_COD_CONTRATO=CONTRATO.N_COD_CONTRATO --*
    
    LEFT JOIN REG_PROCESOS.TIPO_CAUSA_RESOLUCION TIPCAUSA ON CONTRATO_RESOLUCION.COD_CAUSA_RESOUCION=TIPCAUSA.COD_CAUSA_RESOUCION
    --AND TIPCAUSA.OPERACION = 2 --nulidad
    --INNER JOIN REG_PROCESOS.ITEM_CONVOCA IC ON CONTRATO.N_CONVOCA = IC.N_CONVOCA --*
    INNER JOIN REG_PROCESOS.ITEM_CONTRATO ICON  ON ICON.N_COD_RESOLUCION=CONTRATO_RESOLUCION.N_COD_RESOLUCION --08092016
    WHERE TIPCAUSA.OPERACION = 2 --nulidad
    
    UNION
    --RESOLUCION
    SELECT 
    CONTRATO_RESOLUCION.N_COD_CONTRATO N_ID_CONTRATO,
    NULL AS N_ID_CONTRATO2,
    CAST (ICON.PROC_ITEM AS VARCHAR2(50)) C_NRO, --*
    'RESOLUCION DE CONTRATO' C_TIPO,
    CONTRATO_RESOLUCION.FEC_CREACION D_FECPUB,--22082016
    --CONTRATO_RESOLUCION.FEC_RESOLUCION D_FECPUB,
    CAST (CONTRATO.M_CONTRATADO AS VARCHAR2(50)) C_MONTO,
    CAST (CONTRATO.M_CONTRATADO AS NUMBER) N_MONTO,
    CAST (CONTRATO_RESOLUCION.N_COD_RESOLUCION AS VARCHAR2(50)) C_NROI, 

  ---  CONTRATO.CODMONEDA_CONTRATO AS C_TIPMON,
    DECODE(CONTRATO.PLAZO,NULL,NULL,CONTRATO.PLAZO) AS C_PLAZO,
     --NULL AS C_ITEMS, --08092016
      CAST (ICON.PROC_ITEM AS NUMBER) C_ITEMS,

      -- ICON.PROC_ITEM AS C_ITEMS, --08092016
   -- ITEM_CONTRATO.PROC_ITEM  C_ITEMS,
    CAST (DECODE(CONVOCATORIA_DOC.DOC_URL,NULL,NULL,'https://zonasegura2.seace.gob.pe/documentos/'--'http://172.16.1.190:8096/documentosportal/'
    || CONVOCATORIA_DOC.DOC_URL) AS VARCHAR2(1000)) C_ARCHIVO,
	CONVOCATORIA_DOC.FEC_UPLOAD  D_FECREGARC,
  CONTRATO_RESOLUCION.ESTADO_CONTRATO AS C_TAM_ARCHIVO
    FROM REG_PROCESOS.CONTRATO_RESOLUCION CONTRATO_RESOLUCION
    LEFT OUTER JOIN REG_PROCESOS.CONVOCATORIA_DOC CONVOCATORIA_DOC
    ON CONTRATO_RESOLUCION.N_COD_CONTRATO = CONVOCATORIA_DOC.N_COD_CONTRATO
    AND CONVOCATORIA_DOC.COD_TIPO_DOC = 610

    INNER JOIN REG_PROCESOS.CONTRATO CONTRATO --*
    ON CONTRATO_RESOLUCION.N_COD_CONTRATO=CONTRATO.N_COD_CONTRATO --*
    
    LEFT JOIN REG_PROCESOS.TIPO_CAUSA_RESOLUCION TIPCAUSA ON CONTRATO_RESOLUCION.COD_CAUSA_RESOUCION=TIPCAUSA.COD_CAUSA_RESOUCION
    AND TIPCAUSA.OPERACION = 1 --resolucion

    INNER JOIN REG_PROCESOS.ITEM_CONTRATO ICON  ON ICON.N_COD_RESOLUCION=CONTRATO_RESOLUCION.N_COD_RESOLUCION --08092016

 WHERE TIPCAUSA.OPERACION = 1 --RESOLUCION
    
  UNION
    --ADELANTO
    SELECT 
    ADELANTO.N_COD_CONTRATO N_ID_CONTRATO,
    NULL AS N_ID_CONTRATO2,
    CAST (ADELANTO.N_ADELANTO AS VARCHAR2(50)) C_NRO,
    'ADELANTO' C_TIPO,
    ADELANTO.FEC_PAGO D_FECPUB,
    CAST (ADELANTO.MONTO_PAGO AS VARCHAR2(50)) C_MONTO,
    CAST (ADELANTO.MONTO_PAGO AS NUMBER) N_MONTO,
    CAST (ADELANTO.N_ADELANTO AS VARCHAR2(50)) C_NROI,
    DECODE(CONTRATO.PLAZO,NULL,NULL,CONTRATO.PLAZO) AS C_PLAZO,
    NULL C_ARCHIVO,
	NULL  D_FECREGARC,
    NULL C_TAM_ARCHIVO, 
    NULL C_ITEMS
    FROM REG_PROCESOS.ADELANTO ADELANTO
    INNER JOIN REG_PROCESOS.CONTRATO CONTRATO 
    ON ADELANTO.N_COD_CONTRATO=CONTRATO.N_COD_CONTRATO 
    LEFT OUTER JOIN REG_PROCESOS.CONVOCATORIA_DOC CONVOCATORIA_DOC 
    ON ADELANTO.N_COD_CONTRATO = CONVOCATORIA_DOC.N_COD_CONTRATO 
    AND CONVOCATORIA_DOC.COD_TIPO_DOC = 600 
    INNER JOIN REG_PROCESOS.ITEM_CONTRATO ITEM_CONTRATO
    ON CONTRATO.N_COD_CONTRATO = ITEM_CONTRATO.N_COD_CONTRATO
    AND Contrato.N_Convoca     = Item_Contrato.N_Convoca
    
    UNION
    --ADICIONAL
    SELECT 
    ADICIONAL_REDUCCION.N_COD_CONTRATO N_ID_CONTRATO,
    NULL AS N_ID_CONTRATO2,
     CAST (ICON.PROC_ITEM AS VARCHAR2(50)) C_NRO,
    'ADICIONAL' C_TIPO,
    ADICIONAL_REDUCCION.FEC_DOC_ADICIONAL D_FECPUB,
    CAST (ADICIONAL_REDUCCION.MONTO_ADICIONAL AS VARCHAR2(50)) C_MONTO,
    CAST (ADICIONAL_REDUCCION.MONTO_ADICIONAL AS NUMBER) N_MONTO,
    CAST (ADICIONAL_REDUCCION.COD_ADICIONAL AS VARCHAR2(50)) C_NROI,
    DECODE(CONTRATO.PLAZO,NULL,NULL,CONTRATO.PLAZO) AS C_PLAZO,
    ICON.PROC_ITEM AS C_ITEMS, --08092016
    CAST (DECODE(CONVOCATORIA_DOC.DOC_URL,NULL,NULL,'https://zonasegura2.seace.gob.pe/documentos/'--'http://172.16.1.190:8096/documentosportal/'
    || CONVOCATORIA_DOC.DOC_URL) AS VARCHAR2(1000)) C_ARCHIVO,
	 CONVOCATORIA_DOC.FEC_UPLOAD  D_FECREGARC,
    CONVOCATORIA_DOC.TAMANO_BYTES AS C_TAM_ARCHIVO --22082016
    --IC.DESCRIPCION AS C_DESCRIPCION --07092016
    
    FROM REG_PROCESOS.ADICIONAL_REDUCCION ADICIONAL_REDUCCION
    INNER JOIN REG_PROCESOS.CONTRATO CONTRATO --*
    ON ADICIONAL_REDUCCION.N_COD_CONTRATO=CONTRATO.N_COD_CONTRATO --*
    LEFT OUTER JOIN REG_PROCESOS.CONVOCATORIA_DOC CONVOCATORIA_DOC --*
    ON ADICIONAL_REDUCCION.N_COD_CONTRATO = CONVOCATORIA_DOC.N_COD_CONTRATO --*
    AND Adicional_Reduccion.Cod_Adicional=CONVOCATORIA_DOC.Cod_Adicional -----JGARCIAF
    -- AND CONVOCATORIA_DOC.COD_TIPO_DOC NOT IN (2450,600,700) --GARANTIAS/CARTA FIANZA
  
      AND CONVOCATORIA_DOC.COD_TIPO_DOC NOT IN (600,610,620,700,1600,2450)

    INNER JOIN REG_PROCESOS.ADICIONAL_REDUCCION_ITEM ICON ON ADICIONAL_REDUCCION.COD_ADICIONAL=ICON.COD_ADICIONAL

    --INNER JOIN REG_PROCESOS.ADICIONAL_REDUCCION_ITEM ICON ON CONTRATO.N_COD_CONTRATO=ICON.N_COD_CONTRATO --08092016
    --INNER JOIN REG_PROCESOS.ITEM_CONVOCA IC ON CONTRATO.N_CONVOCA = IC.N_CONVOCA --07092016
    
    WHERE IND_ADICIONAL_REDUCCION = 1 --adicional
  
    
    UNION
    --REDUCCION
    SELECT 
    ADICIONAL_REDUCCION.N_COD_CONTRATO N_ID_CONTRATO,
    NULL AS N_ID_CONTRATO2,
    CAST (ICON.PROC_ITEM AS VARCHAR2(50)) C_NRO,
    'REDUCCION' C_TIPO,
    ADICIONAL_REDUCCION.FEC_DOC_ADICIONAL D_FECPUB,
    CAST (ADICIONAL_REDUCCION.MONTO_ADICIONAL AS VARCHAR2(50)) C_MONTO,
    CAST (ADICIONAL_REDUCCION.MONTO_ADICIONAL AS NUMBER) N_MONTO,
    CAST (ADICIONAL_REDUCCION.COD_ADICIONAL AS VARCHAR2(50)) C_NROI,
    DECODE(CONTRATO.PLAZO,NULL,NULL,CONTRATO.PLAZO) AS C_PLAZO,
    ICON.PROC_ITEM AS C_ITEMS, --08092016
    CAST (DECODE(CONVOCATORIA_DOC.DOC_URL,NULL,NULL,'https://zonasegura2.seace.gob.pe/documentos/'--'http://172.16.1.190:8096/documentosportal/'
    || CONVOCATORIA_DOC.DOC_URL) AS VARCHAR2(1000)) C_ARCHIVO,
	 CONVOCATORIA_DOC.FEC_UPLOAD  D_FECREGARC,
    CONVOCATORIA_DOC.TAMANO_BYTES AS C_TAM_ARCHIVO --22082016
    --IC.DESCRIPCION AS C_DESCRIPCION --07092016
    
    FROM REG_PROCESOS.ADICIONAL_REDUCCION ADICIONAL_REDUCCION
    INNER JOIN REG_PROCESOS.CONTRATO CONTRATO --*
    ON ADICIONAL_REDUCCION.N_COD_CONTRATO=CONTRATO.N_COD_CONTRATO --*
    LEFT OUTER JOIN REG_PROCESOS.CONVOCATORIA_DOC CONVOCATORIA_DOC --*
    ON ADICIONAL_REDUCCION.N_COD_CONTRATO = CONVOCATORIA_DOC.N_COD_CONTRATO --*
    AND Adicional_Reduccion.Cod_Adicional=CONVOCATORIA_DOC.Cod_Adicional  -----JGARCIAF
   --  AND CONVOCATORIA_DOC.COD_TIPO_DOC NOT IN (2450,600)
    AND CONVOCATORIA_DOC.COD_TIPO_DOC NOT IN (600,610,620,700,1600,2450)
    INNER JOIN REG_PROCESOS.ADICIONAL_REDUCCION_ITEM ICON ON ADICIONAL_REDUCCION.COD_ADICIONAL=ICON.COD_ADICIONAL


 --INNER JOIN REG_PROCESOS.ADICIONAL_REDUCCION_ITEM ICON ON CONTRATO.N_COD_CONTRATO=ICON.N_COD_CONTRATO --08092016    --INNER JOIN REG_PROCESOS.ITEM_CONVOCA IC ON CONTRATO.N_CONVOCA = IC.N_CONVOCA --07092016
 -- INNER JOIN REG_PROCESOS.ADICIONAL_REDUCCION_ITEM ICOM ON ADICIONAL_REDUCCION.IND_ADICIONAL_REDUCCION = 2
    WHERE IND_ADICIONAL_REDUCCION = 2 -- REDUCCION;
    
    
    UNION
    --COMPLEMENTARIO
   SELECT 
     COMPLEMENTARIO.N_COD_CONTRATO_DE_RENOVAC N_ID_CONTRATO, 
     NULL AS N_ID_CONTRATO2,
  CAST (ICON.PROC_ITEM AS VARCHAR2(50)) C_NRO, --*
    
    'COMPLEMENTARIO' C_TIPO,
      
    COMPLEMENTARIO.F_CONTRATO D_FECPUB, 
    CAST (COMPLEMENTARIO.M_CONTRATADO AS VARCHAR2(50)) C_MONTO, 
    CAST (COMPLEMENTARIO.M_CONTRATADO AS NUMBER) N_MONTO, 
    CAST (COMPLEMENTARIO.N_CONTRATO AS VARCHAR2(50)) C_NROI,  
    
    DECODE(COMPLEMENTARIO.PLAZO,NULL,NULL,COMPLEMENTARIO.PLAZO) AS C_PLAZO, 
    -- NULL AS C_ITEMS,
  ICON.PROC_ITEM AS C_ITEMS, --08092016
    CAST (DECODE(CONVOCATORIA_DOC.DOC_URL,NULL,NULL,'https://zonasegura2.seace.gob.pe/documentos/'--'http://172.16.1.190:8096/documentosportal/'
    || CONVOCATORIA_DOC.DOC_URL) AS VARCHAR2(1000)) C_ARCHIVO,
	 CONVOCATORIA_DOC.FEC_UPLOAD  D_FECREGARC,
    CONVOCATORIA_DOC.TAMANO_BYTES AS C_TAM_ARCHIVO --22082016

    FROM REG_PROCESOS.CONTRATO COMPLEMENTARIO 
    
     LEFT OUTER JOIN REG_PROCESOS.CONVOCATORIA_DOC CONVOCATORIA_DOC 
    ON COMPLEMENTARIO.N_COD_CONTRATO = convocatoria_doc.cod_proro --* 
    --AND CONVOCATORIA_DOC.COD_TIPO_DOC = 903
    
INNER JOIN REG_PROCESOS.ITEM_CONTRATO ICON ON COMPLEMENTARIO.N_COD_CONTRATO=ICON.N_COD_CONTRATO --08092016
AND COMPLEMENTARIO.COD_OPERACION_CONTRATO = 6

 WHERE COMPLEMENTARIO.COD_OPERACION_CONTRATO = 6   AND CONVOCATORIA_DOC.COD_TIPO_DOC = 903
    
    UNION
    --PENALIDAD
    SELECT 
    PENALIDAD.N_COD_CONTRATO N_ID_CONTRATO,
    NULL AS N_ID_CONTRATO2,
        CAST (PENALIDAD.N_SANCION AS VARCHAR2(50)) C_NROI,
    'PENALIDAD' C_TIPO,
    --PENALIDAD.PENALIDAD_FECHA D_FECPUB,
    PENALIDAD.F_REGISTRO, --24082016
    CAST (PENALIDAD.PENALIDAD_MONTO AS VARCHAR2(50)) C_MONTO,
    CAST (PENALIDAD.PENALIDAD_MONTO AS NUMBER) N_MONTO,
        CAST (PENALIDAD.N_SANCION AS VARCHAR2(50)) C_NRO,
   
    DECODE(CONTRATO.PLAZO,NULL,NULL,CONTRATO.PLAZO) AS C_PLAZO,
     NULL AS C_ITEMS, --08092016
    CAST (DECODE(CONVOCATORIA_DOC.DOC_URL,NULL,NULL,'https://zonasegura2.seace.gob.pe/documentos/'--'http://172.16.1.190:8096/documentosportal/'
    || CONVOCATORIA_DOC.DOC_URL) AS VARCHAR2(1000)) C_ARCHIVO,
	 CONVOCATORIA_DOC.FEC_UPLOAD  D_FECREGARC,
    CONVOCATORIA_DOC.TAMANO_BYTES AS C_TAM_ARCHIVO --22082016
    --- AS C_DESCRIPCION  --07092016
  
    FROM REG_PROCESOS.SANCION PENALIDAD -- PENALIDAD
    INNER JOIN REG_PROCESOS.CONTRATO CONTRATO 
    ON PENALIDAD.N_COD_CONTRATO=CONTRATO.N_COD_CONTRATO --*
    LEFT OUTER JOIN REG_PROCESOS.CONVOCATORIA_DOC CONVOCATORIA_DOC --*
    ON CONTRATO.N_COD_CONTRATO = CONVOCATORIA_DOC.N_COD_CONTRATO --*
        AND CONVOCATORIA_DOC.COD_TIPO_DOC NOT IN (600,620,700,1600,2450)

   --AND CONVOCATORIA_DOC.COD_    INNER JOIN REG_PROCESOS.ITEM_CONTRATO ICON  ON ICON.N_COD_RESOLUCION=CONTRATO_RESOLUCION.N_COD_RESOLUCION --08092016
   --TIPO_DOC <> 2450
  --  INNER JOIN REG_PROCESOS.ITEM_CONTRATO ICON ON CONTRATO.N_COD_CONTRATO=ICON.N_COD_CONTRATO --08092016
    --INNER JOIN REG_PROCESOS.ITEM_CONVOCA IC ON CONTRATO.N_CONVOCA = IC.N_CONVOCA --07092016
    
    UNION
    /*
    --LIQUIDACION
    SELECT 
    LIQUIDACION.N_COD_CONTRATO N_ID_CONTRATO,
    CAST (CONTRATO.N_CONTRATO AS VARCHAR2(50)) C_NRO,
    --CAST (LIQUIDACION.COD_LIQUIDACION AS VARCHAR2(50)) C_NRO, --25082016
    'LIQUIDACION' C_TIPO,
    CONTRATO.F_LIQUIDACION D_FECPUB,
    --LIQUIDACION.F_REGISTRO D_FECPUB, --25082016
    CAST (LIQUIDACION.MONTO_LIQUIDACION AS VARCHAR2(50)) C_MONTO,
    CAST (LIQUIDACION.MONTO_LIQUIDACION AS NUMBER) N_MONTO,
    LIQUIDACION.CODMONEDA C_TIPMON,
    DECODE(CONTRATO.PLAZO,NULL,NULL,CONTRATO.PLAZO) AS C_PLAZO,
    ICON.PROC_ITEM AS C_ITEMS, --*
    CAST (DECODE(CONVOCATORIA_DOC.DOC_URL,NULL,NULL,'https://zonasegura.seace.gob.pe/documentos/'--'http://172.16.1.190:8096/documentosportal/'
    || CONVOCATORIA_DOC.DOC_URL) AS VARCHAR2(1000)) C_ARCHIVO,
    CONVOCATORIA_DOC.TAMANO_BYTES AS C_TAM_ARCHIVO --22082016
    
    FROM REG_PROCESOS.CONTRATO_LIQUIDACION LIQUIDACION -- LIQUIDACION
    INNER JOIN REG_PROCESOS.CONTRATO CONTRATO 
    ON LIQUIDACION.N_COD_CONTRATO=CONTRATO.N_COD_CONTRATO --*
    --LEFT OUTER JOIN REG_PROCESOS.CONVOCATORIA_DOC CONVOCATORIA_DOC --*25082016
    INNER JOIN REG_PROCESOS.CONVOCATORIA_DOC CONVOCATORIA_DOC --*
    ON CONTRATO.N_COD_CONTRATO = CONVOCATORIA_DOC.N_COD_CONTRATO --*
    AND CONVOCATORIA_DOC.COD_TIPO_DOC NOT IN (2450, 600)
    INNER JOIN REG_PROCESOS.ITEM_CONTRATO ICON ON CONTRATO.N_COD_CONTRATO=ICON.N_COD_CONTRATO
    WHERE CONTRATO.COD_OPERACION_CONTRATO = 8---*****
    */
    --LIQUIDACION VERSION 25082016
    SELECT 
    --LIQUIDACION.N_COD_CONTRATO N_ID_CONTRATO, --25082016
    CONTRATO.N_COD_CONTRATO N_ID_CONTRATO,
    NULL AS N_ID_CONTRATO2,
    CAST (CONTRATO.N_CONTRATO AS VARCHAR2(50)) C_NRO,
    --CAST (LIQUIDACION.COD_LIQUIDACION AS VARCHAR2(50)) C_NRO, --25082016
    'LIQUIDACION' C_TIPO,
    CONTRATO.F_LIQUIDACION D_FECPUB,
    --LIQUIDACION.F_REGISTRO D_FECPUB, --25082016
    --CAST (LIQUIDACION.MONTO_LIQUIDACION AS VARCHAR2(50)) C_MONTO, --25082016
    CAST (CONTRATO.MONTO_LIQUIDACION AS VARCHAR2(50)) C_MONTO,
    CAST (CONTRATO.MONTO_LIQUIDACION AS NUMBER) N_MONTO,
    --LIQUIDACION.CODMONEDA C_TIPMON,--25082016
    --CONTRATO.CODMONEDA_CONTRATO C_TIPMON,
    CAST (CONTRATO.N_CONTRATO AS VARCHAR2(50)) C_NROI,
    DECODE(CONTRATO.PLAZO,NULL,NULL,CONTRATO.PLAZO) AS C_PLAZO,
     NULL AS C_ITEMS, --08092016
    CAST (DECODE(CONVOCATORIA_DOC.DOC_URL,NULL,NULL,'https://zonasegura2.seace.gob.pe/documentos/'--'http://172.16.1.190:8096/documentosportal/'
    || CONVOCATORIA_DOC.DOC_URL) AS VARCHAR2(1000)) C_ARCHIVO,
	 CONVOCATORIA_DOC.FEC_UPLOAD  D_FECREGARC,
    CONVOCATORIA_DOC.TAMANO_BYTES AS C_TAM_ARCHIVO --22082016
    --IC.DESCRIPCION AS C_DESCRIPCION --07092016
    
    FROM REG_PROCESOS.CONTRATO CONTRATO -- LIQUIDACION
    --INNER JOIN REG_PROCESOS.CONTRATO_LIQUIDACION LIQUIDACION
    --ON LIQUIDACION.N_COD_CONTRATO=CONTRATO.N_COD_CONTRATO --*
    --LEFT OUTER JOIN REG_PROCESOS.CONVOCATORIA_DOC CONVOCATORIA_DOC --*25082016
    INNER JOIN REG_PROCESOS.CONVOCATORIA_DOC CONVOCATORIA_DOC --*
    ON CONTRATO.N_COD_CONTRATO = CONVOCATORIA_DOC.N_COD_CONTRATO --*
        AND CONVOCATORIA_DOC.COD_TIPO_DOC = 700

  --  AND CONVOCATORIA_DOC.COD_TIPO_DOC NOT IN (2450, 600)
    --INNER JOIN REG_PROCESOS.ITEM_CONTRATO ICON ON CONTRATO.N_COD_CONTRATO=ICON.N_COD_CONTRATO --08092016
    --INNER JOIN REG_PROCESOS.ITEM_CONVOCA IC ON CONTRATO.N_CONVOCA = IC.N_CONVOCA --07092016
    WHERE CONTRATO.COD_OPERACION_CONTRATO = 8---*****
    
    --LIQUIDACION VERSION 25082016
    
    UNION
    --CONFORMIDAD
   SELECT 
    CONFORMIDAD.N_COD_CONTRATO N_ID_CONTRATO,
    NULL AS N_ID_CONTRATO2,
   -- CAST (CONFORMIDAD.N_CONTRATO AS VARCHAR2(50)) C_NRO,
    CAST (ICON.PROC_ITEM AS VARCHAR2(50)) C_NRO,
    'CONFORMIDAD' C_TIPO,
    CONFORMIDAD.F_REGISTRO D_FECPUB, --24082016V2M_CONTRATADO
    CAST (CONFORMIDAD.M_CONTRATADO AS VARCHAR2(50)) C_MONTO,
    CAST (CONFORMIDAD.MONTO_LIQUIDACION AS NUMBER) N_MONTO,
    --CONFORMIDAD.CODMONEDA_CONTRATO C_TIPMON,
     CAST (CONFORMIDAD.N_CONTRATO AS VARCHAR2(50)) C_NRI,
    DECODE(CONFORMIDAD.PLAZO_REAL,NULL,NULL,CONFORMIDAD.PLAZO_REAL) AS C_PLAZO, 
    
  -- CAST (CONFORMIDAD.PLAZO_REAL AS NUMBER) C_PLAZO,
 --NULL AS C_PLAZO,
    -- NULL AS C_ITEMS,
    ICON.PROC_ITEM AS C_ITEMS,
    CAST (DECODE(CONVOCATORIA_DOC.DOC_URL,NULL,NULL,'https://zonasegura2.seace.gob.pe/documentos/'--'http://172.16.1.190:8096/documentosportal/'
    || CONVOCATORIA_DOC.DOC_URL) AS VARCHAR2(1000)) C_ARCHIVO,
	 CONVOCATORIA_DOC.FEC_UPLOAD  D_FECREGARC,
    CONVOCATORIA_DOC.TAMANO_BYTES AS C_TAM_ARCHIVO --22082016
  --08092016

 -- NULL AS C_ARCHIVO,
-- NULL AS  C_TAM_ARCHIVO

   
   FROM REG_PROCESOS.CONTRATO CONFORMIDAD --CONFORMIDAD
    LEFT OUTER JOIN REG_PROCESOS.CONVOCATORIA_DOC CONVOCATORIA_DOC --*24082016
    ON CONFORMIDAD.N_COD_CONTRATO = CONVOCATORIA_DOC.N_COD_CONTRATO --*
    AND CONVOCATORIA_DOC.COD_TIPO_DOC =700 --GARANTIA , CONTRATO   
  --  INNER JOIN REG_PROCESOS.CONTRATO_LIQUIDACION LIQUIDACION --24082016
   -- ON CONFORMIDAD.N_COD_CONTRATO = LIQUIDACION.N_COD_CONTRATO--24082016
   INNER JOIN REG_PROCESOS.ITEM_CONTRATO ICON ON CONFORMIDAD.N_COD_CONTRATO=ICON.N_COD_CONTRATO --08092016

    WHERE CONFORMIDAD.COD_OPERACION_CONTRATO = 7 -- CONFORMIDAD
    
    UNION 
    --INTERVENCION ECONOMICA?
    SELECT 
   INTERVENCION.N_COD_CONTRATO N_ID_CONTRATO,
   NULL AS N_ID_CONTRATO2,
    CAST (INTERVENCION.N_CONTRATO AS VARCHAR2(50)) C_NROI,
    'INTERVENCION' C_TIPO,
    --TO_DATE(INTERVENCION.FEC_INTERVENCION,'DD/MM/YYYY') D_FECPUB,
    CONVOCATORIA_DOC.FEC_UPLOAD D_FECPUB, --24082016
    CAST (INTERVENCION.M_CONTRATADO AS VARCHAR2(50)) C_MONTO,
    CAST (INTERVENCION.M_CONTRATADO AS NUMBER) N_MONTO,
    --INTERVENCION.CODMONEDA_CONTRATO C_TIPMON,
    CAST (INTERVENCION.N_CONTRATO AS VARCHAR2(50)) C_NROI,
    DECODE(INTERVENCION.PLAZO,NULL,NULL,INTERVENCION.PLAZO) AS C_PLAZO,
     NULL AS C_ITEMS, --08092016
    CAST (DECODE(CONVOCATORIA_DOC.DOC_URL,NULL,NULL,'https://zonasegura2.seace.gob.pe/documentos/'--'http://172.16.1.190:8096/documentosportal/'
    || CONVOCATORIA_DOC.DOC_URL) AS VARCHAR2(1000)) C_ARCHIVO,
	 CONVOCATORIA_DOC.FEC_UPLOAD  D_FECREGARC,
    CONVOCATORIA_DOC.TAMANO_BYTES AS C_TAM_ARCHIVO --22082016
    --IC.DESCRIPCION AS C_DESCRIPCION --07092016
    
    FROM REG_PROCESOS.CONTRATO INTERVENCION
    RIGHT JOIN REG_PROCESOS.CONVOCATORIA_DOC CONVOCATORIA_DOC --*
    ON INTERVENCION.N_COD_CONTRATO = CONVOCATORIA_DOC.N_COD_CONTRATO --*
  --  AND CONVOCATORIA_DOC.COD_TIPO_DOC NOT IN (2450,600)
      --and CONVOCATORIA_DOC.FEC_UPLOAD < CONVOCATORIA_DOC.FEC_UPLOAD

    --INNER JOIN REG_PROCESOS.ITEM_CONTRATO ICON ON INTERVENCION.N_COD_CONTRATO=ICON.N_COD_CONTRATO --08092016
    --INNER JOIN REG_PROCESOS.ITEM_CONVOCA IC ON INTERVENCION.N_CONVOCA = IC.N_CONVOCA --07092016
    
    WHERE INTERVENCION.COD_TIPO_INTERVENCION IN (1,2,3)
     AND CONVOCATORIA_DOC.COD_TIPO_DOC = 800-- INTERVENCION?
    
    UNION
    --AMPLIACION
     SELECT 
     NVL(CONTRATO.N_COD_CONTRATO_DE_RENOVAC,AMPLIACION.N_COD_CONTRATO) N_ID_CONTRATO,
    -- CONTRATO.N_COD_CONTRATO_DE_RENOVAC N_ID_CONTRATO2, AMPLIACION.N_COD_CONTRATO N_ID_CONTRATO,
   null as N_ID_CONTRATO2,
    CAST (AMPLIACION.COD_AMPLIACION AS VARCHAR2(50)) C_NRO,
    'AMPLIACION' C_TIPO,
    AMPLIACION.F_REGISTRO D_FECPUB,
    NULL AS C_MONTO,
    NULL AS N_MONTO,
    CAST (AMPLIACION.COD_AMPLIACION AS VARCHAR2(50)) C_NROI,
    DECODE(AMPLIACION.DIAS,NULL,NULL,AMPLIACION.DIAS) AS C_PLAZO,
    NULL AS C_ITEMS, --08092016
    NULL AS C_ARCHIVO,--24082016
	NULL D_FECREGARC,
    NULL AS C_TAM_ARCHIVO --22082016
    --IC.DESCRIPCION AS C_DESCRIPCION --07092016
    


    
    FROM REG_PROCESOS.CONTRATO_AMPLIACION_PLAZO AMPLIACION
    
    INNER JOIN REG_PROCESOS.CONTRATO CONTRATO
   ON AMPLIACION.N_COD_CONTRATO=CONTRATO.N_COD_CONTRATO
    LEFT OUTER JOIN REG_PROCESOS.CONVOCATORIA_DOC CONVOCATORIA_DOC --*
    ON CONTRATO.N_COD_CONTRATO = CONVOCATORIA_DOC.N_COD_CONTRATO --*
   -- AND CONVOCATORIA_DOC.COD_TIPO_DOC <> 2450
        AND CONVOCATORIA_DOC.COD_TIPO_DOC NOT IN (600,620,700,1600,2450)
        

UNION
    --PRORROGA
   SELECT 

     COMPLEMENTARIO.N_COD_CONTRATO_DE_RENOVAC N_ID_CONTRATO, 
   NULL AS N_ID_CONTRATO2,
			CAST (ICON.PROC_ITEM AS VARCHAR2(50)) C_NRO, --*
    
    'PRORROGA' C_TIPO,
      
    COMPLEMENTARIO.F_CONTRATO D_FECPUB, 
    CAST (COMPLEMENTARIO.M_CONTRATADO AS VARCHAR2(50)) C_MONTO, 
    CAST (COMPLEMENTARIO.M_CONTRATADO AS NUMBER) N_MONTO, 
    --COMPLEMENTARIO.CODMONEDA_CONTRATO C_TIPMON, 
    CAST (COMPLEMENTARIO.N_CONTRATO AS VARCHAR2(50)) C_NROI, --?
    DECODE(COMPLEMENTARIO.PLAZO,NULL,NULL,COMPLEMENTARIO.PLAZO) AS C_PLAZO, 
    -- NULL AS C_ITEMS,
  ICON.PROC_ITEM AS C_ITEMS, --08092016
    CAST (DECODE(CONVOCATORIA_DOC.DOC_URL,NULL,NULL,'https://zonasegura2.seace.gob.pe/documentos/'--'http://172.16.1.190:8096/documentosportal/'
    || CONVOCATORIA_DOC.DOC_URL) AS VARCHAR2(1000)) C_ARCHIVO,
	 CONVOCATORIA_DOC.FEC_UPLOAD  D_FECREGARC,
    CONVOCATORIA_DOC.TAMANO_BYTES AS C_TAM_ARCHIVO --22082016

    FROM REG_PROCESOS.CONTRATO COMPLEMENTARIO 
    
     LEFT OUTER JOIN REG_PROCESOS.CONVOCATORIA_DOC CONVOCATORIA_DOC 
    ON COMPLEMENTARIO.N_COD_CONTRATO = convocatoria_doc.cod_proro --* 
    --AND CONVOCATORIA_DOC.COD_TIPO_DOC = 903
    
INNER JOIN REG_PROCESOS.ITEM_CONTRATO ICON ON COMPLEMENTARIO.N_COD_CONTRATO=ICON.N_COD_CONTRATO --08092016
AND COMPLEMENTARIO.COD_OPERACION_CONTRATO = 2

 WHERE COMPLEMENTARIO.COD_OPERACION_CONTRATO = 2   AND CONVOCATORIA_DOC.COD_TIPO_DOC = 902;
